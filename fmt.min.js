var CryptoJS=CryptoJS||function(a,b){var c={},d=c.lib={},e=d.Base=function(){function a(){}return{extend:function(b){a.prototype=this;var c=new a;return b&&c.mixIn(b),c.hasOwnProperty("init")||(c.init=function(){c.$super.init.apply(this,arguments)}),c.init.prototype=c,c.$super=this,c},create:function(){var a=this.extend();return a.init.apply(a,arguments),a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),f=d.WordArray=e.extend({init:function(a,c){a=this.words=a||[],this.sigBytes=c!=b?c:4*a.length},toString:function(a){return(a||h).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes,e=a.sigBytes;if(this.clamp(),d%4)for(var f=0;e>f;f++){var g=c[f>>>2]>>>24-f%4*8&255;b[d+f>>>2]|=g<<24-(d+f)%4*8}else if(c.length>65535)for(var f=0;e>f;f+=4)b[d+f>>>2]=c[f>>>2];else b.push.apply(b,c);return this.sigBytes+=e,this},clamp:function(){var b=this.words,c=this.sigBytes;b[c>>>2]&=4294967295<<32-c%4*8,b.length=a.ceil(c/4)},clone:function(){var a=e.clone.call(this);return a.words=this.words.slice(0),a},random:function(b){for(var c=[],d=0;b>d;d+=4)c.push(4294967296*a.random()|0);return new f.init(c,b)}}),g=c.enc={},h=g.Hex={stringify:function(a){for(var b=a.words,c=a.sigBytes,d=[],e=0;c>e;e++){var f=b[e>>>2]>>>24-e%4*8&255;d.push((f>>>4).toString(16)),d.push((15&f).toString(16))}return d.join("")},parse:function(a){for(var b=a.length,c=[],d=0;b>d;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-d%8*4;return new f.init(c,b/2)}},i=g.Latin1={stringify:function(a){for(var b=a.words,c=a.sigBytes,d=[],e=0;c>e;e++){var f=b[e>>>2]>>>24-e%4*8&255;d.push(String.fromCharCode(f))}return d.join("")},parse:function(a){for(var b=a.length,c=[],d=0;b>d;d++)c[d>>>2]|=(255&a.charCodeAt(d))<<24-d%4*8;return new f.init(c,b)}},j=g.Utf8={stringify:function(a){try{return decodeURIComponent(escape(i.stringify(a)))}catch(b){throw new Error("Malformed UTF-8 data")}},parse:function(a){return i.parse(unescape(encodeURIComponent(a)))}},k=d.BufferedBlockAlgorithm=e.extend({reset:function(){this._data=new f.init,this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=j.parse(a)),this._data.concat(a),this._nDataBytes+=a.sigBytes},_process:function(b){var c=this._data,d=c.words,e=c.sigBytes,g=this.blockSize,h=4*g,i=e/h;i=b?a.ceil(i):a.max((0|i)-this._minBufferSize,0);var j=i*g,k=a.min(4*j,e);if(j){for(var l=0;j>l;l+=g)this._doProcessBlock(d,l);var m=d.splice(0,j);c.sigBytes-=k}return new f.init(m,k)},clone:function(){var a=e.clone.call(this);return a._data=this._data.clone(),a},_minBufferSize:0}),l=(d.Hasher=k.extend({cfg:e.extend(),init:function(a){this.cfg=this.cfg.extend(a),this.reset()},reset:function(){k.reset.call(this),this._doReset()},update:function(a){return this._append(a),this._process(),this},finalize:function(a){a&&this._append(a);var b=this._doFinalize();return b},blockSize:16,_createHelper:function(a){return function(b,c){return new a.init(c).finalize(b)}},_createHmacHelper:function(a){return function(b,c){return new l.HMAC.init(a,c).finalize(b)}}}),c.algo={});return c}(Math);!function(){var a=CryptoJS,b=a.lib,c=b.WordArray,d=b.Hasher,e=a.algo,f=[],g=e.SHA1=d.extend({_doReset:function(){this._hash=new c.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(a,b){for(var c=this._hash.words,d=c[0],e=c[1],g=c[2],h=c[3],i=c[4],j=0;80>j;j++){if(16>j)f[j]=0|a[b+j];else{var k=f[j-3]^f[j-8]^f[j-14]^f[j-16];f[j]=k<<1|k>>>31}var l=(d<<5|d>>>27)+i+f[j];l+=20>j?(e&g|~e&h)+1518500249:40>j?(e^g^h)+1859775393:60>j?(e&g|e&h|g&h)-1894007588:(e^g^h)-899497514,i=h,h=g,g=e<<30|e>>>2,e=d,d=l}c[0]=c[0]+d|0,c[1]=c[1]+e|0,c[2]=c[2]+g|0,c[3]=c[3]+h|0,c[4]=c[4]+i|0},_doFinalize:function(){var a=this._data,b=a.words,c=8*this._nDataBytes,d=8*a.sigBytes;return b[d>>>5]|=128<<24-d%32,b[(d+64>>>9<<4)+14]=Math.floor(c/4294967296),b[(d+64>>>9<<4)+15]=c,a.sigBytes=4*b.length,this._process(),this._hash},clone:function(){var a=d.clone.call(this);return a._hash=this._hash.clone(),a}});a.SHA1=d._createHelper(g),a.HmacSHA1=d._createHmacHelper(g)}(),angular.module("fmt",["fmt.player","fmt.playlist","fmt.addthis"]).config(["$sceDelegateProvider",function(a){a.resourceUrlWhitelist(["**"])}]),angular.module("fmt.components.filters.duration",[]).filter("duration",function(){return function(a){if(0>a)return"âˆž";var b=function(a){return(a>9?"":"0")+a};a=a||0;var c=Math.floor(a/3600);a-=3600*c;var d=Math.floor(a/60),e=Math.round(a-60*d),f=c>0?c+":":"";return f+=(d>0?b(d):"00")+":",f+=b(e)}}),angular.module("fmt.components.filters.parse",[]).filter("parse",function(){var a=function(a){var b=+a;return b.toString()===a};return function(b){return b&&(/^true$/i.test(b)?b=!0:/^false$/i.test(b)?b=!1:a(b)?b=parseFloat(b):/^{".+"}?/.test(b)&&(b=angular.fromJson(b))),b}}),angular.module("fmt.components.filters.slug",[]).filter("slug",function(){return function(a){return a?$.trim(a).toLowerCase().replace(/[^\w ]+/g,"").replace(/[ _]+/g,"-"):""}}),angular.module("fmt.components.services.url",[]).service("Url",function(){var a=function(){for(var a=null,c=[],d=arguments&&arguments[0]&&angular.isArray(arguments[0])?arguments[0]:arguments,e=0;e<d.length;e++){var f=d[e];angular.isObject(f)?a=angular.extend(a||{},f):(angular.isString(f)||(f=String(f)),c.push(f.replace(/^\/(?=[^\/])|\/$/g,"")))}var g=c.join("/");return a&&(g+=g.indexOf("?")>0?"&":"?",g+=b(a)),g},b=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&(a[c]===!1||a[c])&&b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")},c=function(a,b){var c=new RegExp("[?|&]"+a+"=([^&;]+?)(&|#|;|$)");return decodeURIComponent((c.exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||b},d=function(a,b,c){var d=b+"="+c,e="?"+d;return a&&(e=a.replace(new RegExp("([?&])"+b+"[^&]*"),"$1"+d),e===a&&(e+="&"+d)),e};return{joinUrl:a,encodeQueryData:b,getURLParameter:c,addUrlParam:d}}),angular.module("fmt.components.services.widget-api",["fmt.components.services.url"]).service("WidgetApi",["$q","$http","$location","Url",function(a,b,c,d){var e=this,f=function(){var a=null;if(window.fmtBaseUrl){var b=window.fmtBaseUrl.match(/(.*\/\/media[0-9]*\.webtv.*)\/cust\/(.*)\/static/i);a=b&&3===b.length?b[1].replace(/media[0-9]*\./i,"api."+b[2]+"."):d.joinUrl(window.fmtBaseUrl.match(/.*\/\/[a-z0-9:\.]*\//i)[0],"api")}else window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.host),a=d.joinUrl(window.location.origin,"api");return a};e.config={apiBaseUrl:f()};var g=function(){var a={api_key:e.config.apiKey,api_nonce:Math.floor(1e7+9e7*Math.random()),api_referrer:e.config.apiReferrer,api_timestamp:Math.round((new Date).getTime()/1e3)+e.config.timedelta},b=d.encodeQueryData(a)+"9n1IzQrHUwy1uWhaiuHY2w7qk4vK1FUO";return _.extend(a,{api_signature:CryptoJS.SHA1(b).toString()}),a},h=a.defer();h.resolve(!0);var i=h.promise,j=_.once(function(){return m("config",{r:(new Date).getTime()}).then(function(a){return e.config=angular.extend(e.config,{apiKey:a.key,version:a.version,timedelta:a.timestamp-Math.round((new Date).getTime()/1e3),apiReferrer:c.search().apiReferrer||window.top.location.host}),a})}),k=function(a){var c=Array.prototype.slice.call(arguments,1),f=e.config.version||"config"===c[0]?i:j();return f.then(function(){c.unshift(e.config.apiBaseUrl),"jsonp"===a&&c.push({callback:"JSON_CALLBACK"});var f=d.joinUrl.apply(this,c),h=/(^players|streams$|stats)/,i="cassidy"!==e.config.version&&h.test(f);return i&&(c.push(g()),f=d.joinUrl.apply(this,c)),b({method:a,url:f,withCredentials:!0})}).then(function(a){return a.data})},l=function(){return"withCredentials"in new XMLHttpRequest||"object"==typeof XDomainRequest},m=function(){var a=Array.prototype.slice.call(arguments);return a.unshift(l()?"get":"jsonp"),k.apply(this,a)};return{get:m}}]),angular.module("fmt.components.services.analytics",[]).constant("fmtAnalyticsConfig",{gaAccount:"UA-46378267-1",fmtEvents:["hit","inst","thru"],gaEvents:{hit:"Hit",inst:"Inst",thru:"Thru",pause:"Pause",play:"Play",seeked:"Seek",volumechange:"Volume"}}).service("Analytics",["$rootScope","$window","$location",function(a,b,c){var d=function(){b.GoogleAnalyticsObject="ga",b.ga=b.ga||function(){(b.ga.q=b.ga.q||[]).push(arguments)},b.ga.l=1*new Date;var a=document.createElement("script"),c=document.getElementsByTagName("script")[0];a.async=1,a.src="//www.google-analytics.com/analytics.js",c.parentNode.insertBefore(a,c)},e=function(a){var c=null;b.location.hostname.match(/localhost|([0-9]{1,3}\.){3}[0-9]{1,3}/i)&&(c={cookieDomain:"none"}),b.ga("create",a,c)},f=function(){a.$on("$viewContentLoaded",function(){(b.ga||angular.noop)("send","pageview",{page:c.path()})})},g=function(a,c,d,e){(b.ga||angular.noop)("send","event",a,c,d,e)},h=function(a,b){a&&(d(),e(a),b&&b.trackPagesEnabled&&f())};return{initialize:h,trackEvent:g}}]),angular.module("fmt.components.services.widget-analytics",["fmt.components.services.widget-api","fmt.components.services.analytics"]).service("WidgetAnalytics",["WidgetApi","Analytics","fmtAnalyticsConfig",function(a,b,c){var d,e,f,g,h=-1,i=-1,j=function(a){a=a||1;var b="function"==typeof d.currentTime?d.currentTime():d.currentTime,c="function"==typeof d.duration?d.duration():d.duration,e=b/c*100;return a*Math.floor(e/a)},k=function(){if(0>h)l("hit"),h=0;else if(!g){var a=j(5);if(a===h)return;a===h+5?(l("inst",a),h=a):a!==i&&(l("thru",a),i=a)}},l=function(d,g,h,i,j){if(g=g||0,h=h||e,i=i||f,j=j||3,h&&_.contains(c.fmtEvents,d)){g=("00"+g).slice(-3);var k="hit"!==d?d+"_p"+g:d;a.get("stats/video",k.toUpperCase(),{gateway_id:j||1,video_id:h.id})}if(c.gaAccount&&_.has(c.gaEvents,d)){var l=h?h.livestream?"Live":"VoD":"External",m=c.gaEvents[d],n=h?"["+h.id+"] "+(h.title||h.name):i;b.trackEvent(l,m,n,g)}},m=function(){c.gaAccount&&b.initialize(c.gaAccount)},n=function(a,b,c){d=a,e=b,f=c||(b&&b.streams&&b.streams.length?b.streams[0].url:null),g=b&&b.livestream,h=i=-1,a&&(a.on?a.on("timeupdate",k):a.addEventListener&&a.addEventListener("timeupdate",k))};return{initialize:m,startTracking:n,trackEvent:l}}]),angular.module("fmt.player",["fmt.components.filters.parse","fmt.components.filters.slug","fmt.components.services.widget-api","fmt.components.services.widget-analytics"]).constant("fmtPlayerConfig",{elementId:"fmt-player",src:null,content:"",autoplayEnabled:!1,playerHtml5:"videojs",playerFlash:"videojs",techOrder:"html5_flash",posterUrl:"",playerSwfBaseUrl:"",seoEnabled:!1,statsEnabled:!0,plugin_flumotioncdn:"${player_base_url}/FlumotionCDNPlugin.swf",flumotioncdn_namespace:"http://www.flumotion.com/plugins/flumotioncdn/1.0",flumotioncdn_hd:!0,flumotioncdn_high:!0,flumotioncdn_med:!0,flumotioncdn_low:!0,plugin_menudisplay:null,menudisplay_namespace:"http://www.flumotion.com/plugins/menudisplay/1.0",menudisplay_likeInfoVisible:!0,menudisplay_imageVisible:!0,menudisplay_autoHideEnabled:!0,menudisplay_autoHideTimeout:3,menudisplay_nameVisible:!0,menudisplay_descriptionVisible:!1,menudisplay_tooltipsEnabled:!0,menudisplay_shareButtonEnabled:!1,menudisplay_likeButtonEnabled:!1,menudisplay_embedButtonEnabled:!1,menudisplay_downloadButtonEnabled:!1,menudisplay_commentsButtonEnabled:!1,plugin_share:null,share_namespace:"http://www.flumotion.com/plugins/share/1.0",share_enabled:!0,plugin_embed:null,embed_namespace:"http://www.flumotion.com/plugins/embed/1.0",embed_enabled:!0,plugin_comments:null,comments_namespace:"http://www.flumotion.com/plugins/comments/1.0",comments_enabled:!0,plugin_captioning:null,captioning_namespace:"http://www.flumotion.com/plugins/captioning/1.0",captioning_enabled:!0,plugin_relatedcontent:null,relatedcontent_namespace:"http://www.flumotion.com/plugins/relatedcontent/1.0",relatedcontent_enabled:!0,plugin_branding:null,branding_namespace:"http://www.flumotion.com/plugins/branding/1.0",branding_uri:"http://www.flumotion.com/wp-content/uploads/header_logo3.png",branding_width:120,branding_height:80,branding_clickThroughURL:null,branding_verticalAlign:"top",branding_horizontalAlign:"right",branding_alpha:.8,playButtonOverlay:!0,bufferingOverlay:!0,scaleMode:"letterbox",posterScaleMode:"letterbox",controlBarMode:"docked",volumeBarVisible:!0,qualitiesVisible:!0,fullscreenVisible:!0,controlBarHotButtons:"",controlBarTooltipsEnabled:!1,skin:"flumotion_v3",primaryColor:"#000000",secondaryColor:"#ff0000",tertiaryColor:"#ff0000",backgroundColor:"#000000"}).controller("FmtPlayerController",["$rootScope","$scope","$filter","$location","fmtPlayerConfig","WidgetAnalytics","WidgetApi",function(a,b,c,d,e,f,g){var h=this;this.setupConfiguration=function(){var a=_.defaults(_.pick(b,_.keys(e)),e);_.each(a,function(b,d){a[d]=c("parse")(b)}),a.autoPlay=a.autoplayEnabled,a.api_referrer=a.apiReferrer,a.playerId=a.playerId||a.player,a.campaignId=a.campaignId||a.campaign||a.explicitCampaignId,a.playerHtml5=/iPhone|iPod|iPad/i.test(navigator.userAgent)?"browser":a.playerHtml5,a.content&&a.src&&(a.srcExtraParams=a.src.substring(b.config.src.indexOf("?")+1)),b.config=a},this.initialize=function(){b.config.contentn&&b.config.statsEnabled&&f.initialize(b.config),h.loadContent()},this.loadContent=function(){b.config.content?(h.loadPod(b.config.content),h.loadStreams({id:b.config.content})):b.config.src&&h.loadSrc(b.config.src)},this.loadPod=function(a){g.get("pods",a,{extended:!0}).then(function(a){b.pod=a})},this.loadStreams=function(a){a.streams?b.pod=a:g.get("pods",a.id,"streams").then(function(c){a.streams=c,b.pod=a})},this.loadSrc=function(a){a&&(b.streams=[{url:a,mimetype:"video/"+c("extension")(a)}])},a.$on("fmtPodSelected",function(a,e){e&&e!==b.pod&&(b.pod&&b.pod.id!==e.id&&(b.config.autoplayEnabled=!0),b.config.seoEnabled&&d.path(e.id+"/"+c("slug")(e.name)),h.loadStreams(e))}),b.$watch("config.src",h.loadSrc)}]).directive("fmtPlayer",["$parse","fmtPlayerConfig",function(a,b){var c=function(){var a=_.clone(b);return _.each(a,function(b,c){a[c]="@"}),a};return{templateUrl:"template/player/player.html",controller:"FmtPlayerController",scope:c(),link:function(a,b,c,d){d.setupConfiguration(),b.addClass(["fmt-w","player",a.config.elementId].join(" ")),d.initialize(),a.$watch("src+techOrder+playerHtml5",d.setupConfiguration)}}}]).directive("fmtPlayerBrowser",["WidgetAnalytics",function(a){return{templateUrl:"template/player/player-browser.html",require:"^fmtPlayer",replace:!0,scope:{pod:"=",config:"="},link:function(b,c){b.$watch("config.autoplayEnabled",function(a){a?c.attr("autoplay",a):c.removeAttr("autoplay")}),b.$watch("config.controlBarMode",function(a){"none"!==a?c.attr("controls",a):c.removeAttr("controls")}),b.config.statsEnabled&&a.startTracking(c[0],b.pod)}}}]).controller("FmtPlayerVideojsController",["$rootScope","$scope","WidgetAnalytics","WidgetApi","Url",function(a,b,c,d,e){var f=function(a){var c="";_.each(a,function(a){c+="<source src="+a.url+" type="+a.mimetype+"></source>"});var d=$("."+b.config.elementId),e='<video id=ID class="video-js vjs-default-skin" width=WIDTH height=HEIGHT>STREAMS</video>';return e.replace("ID",b.config.elementId).replace("WIDTH",d.width()).replace("HEIGHT",d.height()).replace("STREAMS",c)},g=function(){var a={flashVars:{javascriptCallbackFunction:"onFlashCallbackFunction"}},c=b.config.playerSwfBaseUrl.replace(/^https:\/\//,"//"),f=e.joinUrl(c,"audio/current"),g="strobe"===b.config.playerFlash?"PlayerStrobe.swf":"StrobeMediaPlayback.swf";if(a.swf=e.joinUrl(f,g),b.config.playerId&&b.config.content){var h=e.joinUrl(d.getBaseUrl(),"player.xml",{pod:b.config.content,player:b.config.playerId,campaignId:b.config.campaignId,srcExtraParams:b.config.srcExtraParams});a.flashVars.configuration=encodeURIComponent(h)}else{var i=_.defaults({base_path:f+"/",podId:b.config.content},b.config);i=_.omit(i,"configuration");for(var j in i)!i.hasOwnProperty(j)||void 0!==i[j]&&null!==i[j]||delete i[j];a.flashVars=_.defaults(a.flashVars,i)}if(b.config.content&&"strobe"===b.config.playerFlash&&"cassidy"!==b.config.apiVersion){var k=e.joinUrl(d.getBaseUrl(),"pods",b.config.content,"streams.f4m",d.sign());a.flashVars.srcManifest=encodeURIComponent(k)}return a},h=function(a){var c={controls:"none"!==b.config.controlBarMode,preload:"auto",poster:(b.pod?b.pod.video_image_url||b.pod.posterUrl:null)||b.config.posterUrl,autoplay:b.config.autoplayEnabled,techOrder:a,flash:{params:{allowFullScreen:!0}}};return b.config.playerFlash&&"videojs"!==b.config.playerFlash&&_.extend(c.flash,g()),c},i=function(){if(b.playerVideoJs){var a=$("."+b.config.elementId);b.playerVideoJs.width(a.width()).height(a.height())}},j=function(){b.changingQuality&&(b.playerVideoJs.currentTime(b.changingQuality.time),b.changingQuality=null)},k=function(){},l=function(){b.playerVideoJs=this,b.config.statsEnabled&&c.startTracking(this,b.pod),this.on("loadeddata",j),this.on("durationchange",k),this.on("ended",function(){a.$emit("fmtPodFinished")}),b.changingQuality&&!b.changingQuality.paused&&this.play(),a.$emit("fmtPodReady",{pod:b.pod,streams:b.pod.streams,currentStreamUrl:this.currentSrc()})},m=function(a){var b=!1,c=document.createElement("video");return c.canPlayType&&(b=_.some(a,function(a){return c.canPlayType(a)})),b};this.initialize=function(){if(b.pod&&$(".player-wrapper")){if(!angular.element(document.querySelector("#cssFmtPlayerVideojs")).length){var a='<link id="cssFmtPlayerVideojs" href="//vjs.zencdn.net/4.3/video-js.css" rel="stylesheet">';angular.element(document.querySelector("head")).append(a)}b.playerVideoJs=null;var c=f(b.pod.streams);$("."+b.config.elementId+" .player-wrapper").html(c),"strobe"===b.config.playerFlash&&(videojs.Flash.bd=_.extend(videojs.Flash.bd,{"audio/flv":"FLV","audio/x-flv":"FLV","audio/mp3":"FLV","audio/m4a":"FLV","audio/mpeg":"FLV"}));var d=b.config.techOrder.split("_");m(_.pluck(b.pod.streams,"mimetype"))||(d=_.without(d,"html5"));var e=h(d);b.videoTag=$("#"+b.config.elementId)[0],videojs(b.videoTag,e).ready(l)}},$(window).resize(i),a.$on("fmtPodQualitySelected",function(a,c){b.changingQuality={time:b.playerVideoJs.currentTime(),paused:b.playerVideoJs.paused()},b.pod.streams=[c.stream],b.playerVideoJs.controls(!1)}),b.onFlashCallbackFunction=function(d,e,f){"onJavaScriptBridgeCreated"===e?videojs.Flash.onReady(d):"complete"===e?a.$emit("fmtPodFinished",b.pod):"metadataChanged"===e&&a.$emit("fmtPodMetadataChanged",f.value),b.config.statsEnabled&&c.trackEvent(e,f?f.value:null,b.pod,b.streams[0].url,f.gatewayId)}}]).directive("fmtPlayerVideojs",function(){return{template:'<div><div class="player-wrapper"></div>',controller:"FmtPlayerVideojsController",replace:!0,scope:{pod:"=",config:"="},link:function(a,b,c,d){var e=!1;a.$watch("pod",function(b){b&&b.streams&&a.config.techOrder&&(e?d.initialize():(e=!0,$.getScript("http://vjs.zencdn.net/4.3/video.js",d.initialize)))})}}}),window.onFlashCallbackFunction=function(a,b,c){var d=angular.element("#"+a).scope();d.onFlashCallbackFunction(a,b,c),d.$apply()},angular.module("fmt.playlist",["fmt.components.filters.duration","fmt.components.filters.parse","fmt.components.services.widget-api"]).constant("fmtPlaylistConfig",{elementId:"fmt-playlist",content:null,cssUrl:null,nameVisible:!0,thumbVisible:!0,durationVisible:!0,likesVisible:!0,dateVisible:!1,columns:1,currentItemId:null,autoAdvanceEnabled:!1}).controller("FmtPlaylistController",["$window","$document","$rootScope","$scope","$http","$timeout","$location","WidgetApi",function(a,b,c,d,e,f,g,h){var i=this;this.selectItemById=function(a){if(d.config.currentItemId=a,d.items&&d.items.length&&"none"!==a){var b=_.findWhere(d.items,{id:a+""});d.selectItem(b||d.items[0])}},this.onContentLoaded=function(a){d.items=a.data||a.items||a;var b=g.path().match(/^\/(\d+)\//);i.selectItemById(b&&b.length>1&&_.findWhere(d.items,{id:b[1]})?parseInt(b[1]):d.config.currentItemId)},this.initialize=function(){angular.isNumber(d.config.content)?h.get("smartlists",d.config.content,"items").then(i.onContentLoaded):d.config.content&&e.get(d.config.content).then(i.onContentLoaded)},d.itemClass=function(a){var b={active:d.currentItem&&a.id===d.currentItem.id};return d.config.columns<=6&&(b["col-md-"+12/d.config.columns]=!0),b},d.selectItem=function(a){c.$emit("fmtPodSelected",a)},c.$on("fmtPodSelected",function(a,b){f(function(){d.currentItem=b})}),c.$on("fmtPodFinished",function(){if(d.config.autoAdvanceEnabled){var a=d.items.indexOf(d.currentItem)+1;a<d.items.length&&d.selectItem(d.items[a])}})}]).directive("fmtPlaylist",["$filter","fmtPlaylistConfig",function(a,b){var c=function(){var a=angular.copy(b);return angular.forEach(a,function(b,c){a[c]="@"}),a};return{templateUrl:"template/playlist/playlist.html",controller:"FmtPlaylistController",scope:c(),link:function(c,d,e,f){var g=function(){var d=_.defaults(_.pick(c,_.keys(b)),b);_.each(d,function(b,c){d[c]=a("parse")(b)}),c.config=d};g(),d.addClass(["fmt","fmt-playlist",c.config.elementId].join(" ")),f.initialize();var h=_.without(_.keys(b),"currentItemId").join("+");c.$watch(h,g),c.$watch("currentItemId",f.selectItemById)}}}]).directive("fmtPlaylistItem",function(){return{templateUrl:"template/playlist/playlist-item.html",require:"^fmtPlaylist"}}),angular.module("fmt.addthis",["fmt.components.services.url"]).constant("fmtAddthisConfig",{elementId:"fmt-addthis",pubid:"ra-52f8a2223eb7c112",size:"large",usePreferred:!0,numPreferred:5,url:null,addthisTitle:null,addthisDescription:null,buttons:["facebook","google_plusone_share","twitter","linkedin","tuenti"]}).controller("FmtAddthisController",["$rootScope","$scope","$location","$timeout","Url",function(a,b,c,d,e){var f=this;this.toolboxTag=null,b.toolboxClass=function(a){return{addthis_default_style:!0,addthis_32x32_style:"large"===a}},b.range=function(a){return a?_.range(a):[]},this.initAddthis=function(a){a&&$.getScript("//s7.addthis.com/js/300/addthis_widget.js#pubid="+a+"&async=1",function(){addthis.init()})},this.updateAddthis=function(a){"undefined"!=typeof addthis&&d(function(){if(a){var d=b.config.url||c.absUrl();b.config.url=a.id?e.addUrlParam(d,"pod",a.id):d,b.config.addthisTitle=a.name||(a.streams.length?a.streams[0].url:"Video"),b.config.addthisDescription=a.description||""}addthis.toolbox(f.toolboxTag)})},this.onPodChanged=function(a,b){var c=b.pod||b;c.streams=c.streams||b.streams||[],f.updateAddthis(c)}}]).directive("fmtAddthis",["$rootScope","$filter","fmtAddthisConfig",function(a,b,c){var d=function(){var a=_.clone(c);return _.each(a,function(b,c){a[c]="@"}),a};return{templateUrl:"template/addthis/addthis.html",controller:"FmtAddthisController",scope:d(),link:function(d,e,f,g){var h=function(){var a={};_.each(c,function(e,f){a[f]=angular.isDefined(d[f])?"buttons"===f?d[f].split(","):b("parse")(d[f]):c[f]}),d.config=a};h(),e.addClass(["fmt","addthis",d.config.elementId].join(" ")),g.toolboxTag=e.children(".addthis_toolbox")[0],g.initAddthis(d.config.pubid),d.$watch("pubid",g.initAddthis),d.$watch("size+buttons+usePreferred+numPreferred",h),d.$watch("url+addthisTitle+addthisDescription",function(){h(),g.updateAddthis()}),a.$on("fmtPodReady",g.onPodChanged),a.$on("fmtPodSelected",g.onPodChanged)}}}]).directive("fmtAddthisButton",function(){return{require:"^fmtAddthis",link:function(a,b,c,d){a.$last&&d.updateAddthis()}}});